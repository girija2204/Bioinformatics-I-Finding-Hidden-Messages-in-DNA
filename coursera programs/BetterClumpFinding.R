#The previous program for clump finding takes a lot of time to find clumps. As it calculates frequency array in each
#and every iteration. So this program is the modified one, in which frequency array is calculated only once.

source("/home/giri/Downloads/MTech Thesis/coursera programs/NumberToPattern.R")
#library(bigmemory)
#options(bigmemory.typecast.warning=FALSE)
BetterClumpFinding = function(text, l, k, t){
  FrequentPatterns <- vector()
  x = '^'(4,k)
  Clump <- big.matrix(nrow = 1, ncol = x, type = "integer", init = 0)
  FrequencyArray <- big.matrix(nrow = 1, ncol = x, type = "integer", init = 0)
  
  FrequencyArray <- ComputingFrequencies(FrequencyArray, substr(text, 1, l), k)
  for (i in 1:x) {
    if(FrequencyArray[1,i] >= t)
      Clump[1,i] = 1
  }
  for (i in 2:(nchar(text)-l+1)) {
    FirstPattern <- substr(text, i-1, i + k - 2)
    LastPattern <- substr(text, i + l - k, i + l - 1)
    index <- PatternToNumber(FirstPattern)
    FrequencyArray[1,index+1] <- FrequencyArray[1,index+1] - 1
    index <- PatternToNumber(LastPattern)
    FrequencyArray[1,index+1] <- FrequencyArray[1,index+1] + 1
    if(FrequencyArray[1,index+1] >= t)
      Clump[1,index+1] <- 1
  }
  for (i in 1:x) {
    if(Clump[1,i] == 1){
      FrequentPatterns <- append(FrequentPatterns, NumberToPattern(i-1, k))
    }
  }
  return(FrequentPatterns)
}

text = "CATTAGGTCTCTTACAAGCAGCTCAGCGGAGCAAGCGAGATGCCATTGGTTGCGAGCGCCCCCGACGTGGGCAGACACTACCCCGACGCAATGCGTCGATGATGCGGACCGGGATCGCGCCCATGTCCGGTTCGCGTCGTGCTATCAGCTTTAGTTTCTCCGTTATACCTGCGTAGTAGCGGCCTAACACGTGCCGTCAAGTTCTGCCCCTGTTCCTGGTCTTACTTTGACGGGGGTGATGGGATGAAGAAAAGGCGGGAGAAAAAGATTAACACCTCCGTTCAGCCCAATGCGAGGAGCGGGCCATACACAATGGAAGTTACTCAGGTCTCTTTCTATACAGACAGAGTGGCTCTACTTTCCCACGTTGCACGCACTTCTGCTATGTTGGAATAAACGATTTTAATACAGCGCCCAGCAGCTGTCGGTTATGCCTGCAGGAGGGCTGACGTTCTTGGAAACCGCGTGAAGAGTACTCTGAATCCTAACAGTCGGGAAGCCAGGCCTTGCGACAGATCGCTAGGGGGGGGCGAGCAGTGACATAAGGGGTCGTTGACGTGCACTGTGGATTATTGGGCTGGGTGATGGAAACTTTCCAAGACGAGTCGCTAAGTGAACGAATAATTGGGTGTTAAATAGCTGCCGGCCGAGTCGTGTGCAATTAATAGCGACTGCAGGTGGAGCCGCCCTCCAGTCGTACGCGCCTTCCGGTAAATTTAGTACGGCGCGAGCGACATTCCTACTACGTCAGTGACTTGCAACATTACTAAGGCCACTCGCTTGCTGGGTGGACGAGGGCCACTCGGGAACCATCTCGTTGGACACCCCCAAATATACCGCGGTGGCCACTCGCGTAAAATTCGGCCACTCGGCCTTCAGTGGCCACTCGAGGAGGCCACTCGTCCGACCCCCAAGGAGGCCACTCGTCGGGCCACTCGCACTGGCCACTCGGAATCGCCAATCGGCCACTCGGGCCGGCCACTCGAGCGTATAAGGATAGTCATGGATAAAGTCGATACGTTCTCTCAGAGGGAGGAAGAGCTCGAGGAAGAGGGCCACTCGCGGCCACTCGGGAAGAGAAGAGGGGGCCAGGCCACTCGAGGCCACGGCCACTCGGAGCATTACAGTGGCCCTGGCCACTCGCTCGATGATAAAGCCGTGGTTAGGATGCGTGCGCACCCTGTTGATCAGGTCACAACAACCGCCTCCGGGCCCGGCCACTCGCACTCGAGAGCGCGGCCACTCGCGATGCCGTGCACAGAGGCCACTCGTCAGGAGGAAGGCCACTCGCGAGGGAGGAAGAGCCTGAGGAAGAGGGCCAGGCCACTCGGGCCACTGGCGGCCACTCGCGGAACGAGGAAGAGCGTCAAAGGCAGTGAGGGAGAGGAAGAGAGAGCGCACATAATCTGAGGAAGAGGTTAAACTAACGCGAGGAAGAGGAGACCAGTAGGTGTAGATAACAAAAGTGAGGAAGAGTCGGAGGAAGAGTATTAAGTCAGAACCAGGTACCCACCTGCCGGGCCGGAGGAAGAGAGGAAGAGGAAGAGGAGAGAGTCACTTGTCTTTTTTAAAGTTTCGGGAGGAAGAGGATCCTGGGGAGGAAGAGACTATACGTTGTCGAGGAAGAGCACCGCGCCTGGGAACTATGGTGCGTATGTTGCTGACGGCAGAACGTGTGCTGCATCCACTTACAGCTACCCCTTCTGAAGTCGCCGGATCAAAGGTTTTATCCGGAAGAATCGGGGGCAACGAGTCCCGGGGCATGTCTACACCCCAATTTGTGGGAGGTCATATAATATATACGAGAGCTAGCGCCACGCGAGCGAATACACGTAGTGGGCCAACAACTGTAGTGAGAGAGTCGAACACCGGCTCGAGCGAAGCTAGTTGGTCCTGGGTGGAAAGTAGGAGAGATTCCACTGTCGACTTAGAAGTTAACGCGAAGAATGCACGCCCACTACCTTTAGACGACAACCCCAGGGTCCCTTTCAACCCTCATGATAGGGCGACGGGCATTGGTTTACTTTCCCAGGGCGACCGAGTCCACCTCGTCTCGACACTTACCAGACGCGTCGATGAACTTAGGAGTACTTTTACTGTTAGATTAATGCAGCCTAGATGTCCGCGCCAACATATAGCTGTGCAAGGCGTCCTAACCTCATAGGCAAGGTGAGCAGTCCCCCAAACGAGTGCCTAGCCGCACCAGAGTCGTTTTTGACTCACAGTATATAAGTATTCCTAAATACCGACAAAGGAATCTTTGCTCTCGTCTAAAGCGGAGTTTGAACGTATCCTGGCGTTTCGACGACCTGGCGGCCTCGACGGCGGCCAAATTCTACTGCTACCGTATGCTGCATACTTAGCGGGGTATCGCGTCCTGCATGAACGACACACTAACTACCTACATTAGCAGCGAAACACAAAGTACATTTCAGTGACCATATATAAGAGCCCTAGTGACGGACAGGTTTTGATGCGAGAGAAAGGCTGTAATCCGCAGTAACTCGTCGCTAATGTACCCTGCTCCCGCCGTCATCTGGCTATACTTCGGCCATAAGTAATTGTTTCTTCTAGGACTGTATGGGACTGTATTCGAAGGACTGTATTATGTTGGCGTCGGACTGTATTCAGGTGCGGACTGTATTCTGGACTGTATGGAAGGATAGGATTGCATACAAAGAATAAAATGGTAGCGTCGGAGAGACTAGGATTGCATTACCTTCCCATAGGATTGCAGGGACTGAGGATTGCAGTATGCACACTACTTGGACTGTATGTAGGATTGAGGATTGCATTATTAAAATCCGGACTGTAAGGATTGCAGATTGCAGATCCGCAAGGATTGCAAGGATTGCATCTGTAGGATTGCAATTAGGATTGCAGGAAGGATTGCACCGGACTGTATCGAGACAAGGAGATGGACTGTATACTGTATCCAGGTAGGATTGCATATAGGATTGCAATTTCAAGGATTGCAAGGATTGCACTGTATAGTTGTTAAGGATTGCAGAGGATTGCAAGGATTGCATGTATAGTCATAGGATTGCAACCAAGGATTGCAGCGACAGGATTGCAAAGGATTGCAAGGATTGCAGGAAGAGGATTGCATATAAAATGGACTGTATAGGATTGCATTTGAAGAGCTATACAAATACTCAAGGATTGCAAGGATTGCATGCTTTGAGTAGGTGCTCTTACAGTTACAGGATTGCAAGGATTGCAATCCTCTCTCTAAATTCGCCATCGGAGCGGAACAGTTTTTCCCCGCATCGTGACGGACAGTTTATGGCCCGCAGGCACCGACTCCTTTAAGAGGGCACAGGGCGATCGGGATGAGACACCGACCATTGACCCTGCTGGTGCCTACAACGCCATGGTCGTCCGATTGATCGACGAGCGAGAACGGCCGCGTCTTTGAAGTGCCTCCAGCGACGCAACTGAATGGCGCGGTCTATGACCCGATCGCCTATGGTGCCCGCCGTCAACTAGACACTCAATCTTGAAGACACTAGCAGTGCAGTTTATCATAGTTATGCCAATGCCCGCGAAGGCCCCTTAGACTCTGTATCGCTCCGTAGACGTTACGGGATCGTAACAACTTAGAGCGGTGAACCGTCTGCGTGCGCCACAGAGGAGCCAGCGGTCCGGCGCATGCTCTCCACTGCGGCCCTGTCACGAGTCAGGACTGGTGAGTTAATGTGGCCGTCGTGCGGTCCTGGATCCTTCATGTCTTGTTACAGATCGCTCATGAATCTACCGAGGACGGGTCTGTTTCTCATGAGTCCGTCTCGGCGGATTATTATCGAGTTCTTACTAGAAGCCAGAGGCGTCTAGAGAGTTCTTAGTTCTTACAGTTCTTACGCAGTTCTTACAGTTCTTACAAGTACGCCGTTCAGTAGTTCTTACTGCTCCAATGGAGGGAGCAAGTAGTTCTTACGAGTTCTTACCCGAGCAAGTAATTTTTCATACGCCAGACCGAGGAGCCTTGATGGCAAAGCCGAGTTCCTTGATGGCAGCTTCTTGATGGCAGCAAAGTAGTTCTTACAAGAGTTCTTACATAGTCTTGATGGCTACACCCACTTGATGGCTTGATGGCCCCTTGATGGCGCTTGATGGCTTCCTTGATGGCGCTTGATGGCGCACCTGCATCCCATTGGAGTTCTTACTGAAGTTAGTTCTTGATGGCTTGATGGCACCTTGATGGCCTCTTGATGGCGACTTGATCTTGACTTGATGGCGATGGCCTGATGGCACTCTTGATGGCAGTTCTTACTCTTACTCTAGTTCTTACTTAGGATGAATGAAATAGGATGGAAGTTCTTGATGGCCTTCTTACCTTGATGGCTTGATGGCACTTGATGGCACTCTTCTTGATGGCTCCTCCCATTGGTTGGATGCATAGGATGAAGGACTTGATGGCGATGAATGGTACTTGATGGCTGACTTGATGGCATGGCCCCACTTGATGGCTTGGCCCTTGATGGCAATAGGATGAAGATGTCCCTAGTAGGATGAATATCTCCTCCCATTGGGTTAGCGTGAGGCTGGTCCCATTGGCCCACCGGTCGCGCGGTGTCCACTCTATCCTTAGGATAGGATGAAGGATGAATTAGGATAGGATGAATGAACCCATTGGAAATAGGATGAATTGGCCATTGGAATTATAGTAGTGTGGTCTAGGATGAAATGAATAGGATGAATTATTTGTTACGTCCCCATCCCGTTCACCAATGAGAAACATTGTAGGATGAAGATTAGGATGATAGGATGAATATAGGCGCAGGTTCGAGTTGAAAACGGGGGAGTGTTCCTCCTTAGTAGGATGAACATAGGATGAAATCAAACAACTTAAGTCGAAACTGGCGCTGTGCCCCAGCGAATTTTGAGGAGGAGTCAAAATTTTGAGCAAATTTCAAATTAATTTTGAGAATTTTGAGATAATTTTGAGTAATTTTGAGTATCAAATTTTGAGAATTTTGAGGCACTTCGATATTATCTTGAATTTTGAGTCCTTCAAGAAGTAATTTTGAGCTTTTGGTCGCTGTGGCATGGAGCAATTTTGAGGAGTATGCCCTGAATCTACAACTGCGCGTCACAATTTTGAGAGTCTGGAAGCCTTTTTAATTTTGAAATTTTGAGCGGCTACAATTTTGAGGTGGTTCCCCTTCATCGGCAGAATTTTGAGTCAAGGAGTAATTAATTTTGAGAGTCCAATGGAGACCGCCGGGATTAATTTTGAGTCAATTTTGAGGGTCTCAGCGTAAATTTTGAGGCTATGTGCCACGGAACCGGCTGGATTCTTCAGAATTTTGAGACGCAAGTTTAAATTTTGAGTGAGGGGTCAACGGCCTAATTTTGAGTTCGTACATTCATTATTCGTACATCGTACATTTTTTTCGTACATTTGAGTGGTACCCTTATCGGGTCCGTAGAATTTTGAGCCGCCTCGATCGTACATTTTCACGCCCCAGCAATCGTACATTCATCCTCGTACATTTACTTCGTACATTTCTATGGAATTGTTGGAAACGCCGCTAGTGATCGTACATTCGTACATTCGCGGTGACGGGTGCCTTCAAAACACTAGACAACGCAGGTGATAACGTCCATCCGCAGTTCGTACATTAGTGAGCCACGTGAACATACTCTGGCCAGCCATTTCGTACATTACATTCATTACGGTGGCCACCGCGTAAGCCTTGGCAGCATCTATCGTACATTCGCAACAATAGTCGTACATTATTCGTACATTTACATTTCGTACATCGTACATTCTCGTACATTCGTACATTAACAGCATCGTACATTTTGTGATGGGCCCGGACCATCGTACATTGTACATTTTGGTGGGGTACGAAATCGTACATTTACATTGAATCTGAAGTATCTCGTACATTGGGTAAACGGTCTCCCGGATGGGATAGCGTCGTTCGTACATTATCGTACATTAATGTATTGTCCTCGGCGTATCAGCTATTTAGTGTACAGACGTTGCGGACAATCCCTACGATGGAGTGACCTCCGGGAATCACCTAATTGATTTACAATGGTGGCCAGTCTCCAGAGAGATCCTACACGCACTCCTCTAGAGTGGGACTAGTATTTTTTCAGGTTGATACCCTTCGTAAGCATGAATTCCTTTTCACGAGTGCGCGGTTGTCCCCAGCCTCGCCGATAAAACCCTGGCCGAAGATCAGCGAGCCAGCACTGCCGAGTGCGTGCAAAGATGCAGTCAAAGTCAAAGGTTCTGAGCACTCTTTGGTGCAGGGTCTAGATTGGGGCCAAAGTAGGGAATGCCAGAGTCGCTATCCCGAGTTGTCTAGGTTCGTGTTCGCCTATCGCGCGCTGTAGTTAGAATCGTGCATAACGATCTTATCGTCTCGTTTCATTCAGCCTGGCGTGTGTGCGGAAGTGAGCTGCGTGTTCCTAATACTCACATCTTAGGTCCGCCCCCGTATGTGGAGATGAACCGATATGCTGTGTTTCGAAAGGCGGAAGAGGCGACTATCAAAGTCGAGATGGCTAGTTCTTTTTGGCTCTGAGTCGTCACGCGGCTTATTAAGTAGTGACACCCTGCTCGGTCAATCCGCGGTACCTGAGCGCTAAACAACAATCCACCGTTAGACGCGAGCCGCGGCCCAGCTTGTGCCGTCACTAACCTATCTCAGGTAATCCCAGGGGCAGATACCGAAGGGGCGGTAGCGTGGGGGCGGTAAACCGGGGCGGTAGGTAATTGGGGGGCGGTACTACTGGGGCGGTAGCGGTAACGGGGCGGTACGGCGGGGCGGTAGCGGTAGGGGCGGTAGTTCTATGCGCGTGAAAAGTACAGTCTGAGATAGTCGGGGCGGTAAACACCAGCCCAACTAGTATGGGGCGGTAAGTAACTAGTATTCCTGGGGCGGTGGGGCGGTAAACGGGGCGGTATAGTATCCAAATGGGGCGGTAGTATCTAGTATTCTATTTGAACTAAACTAGTATTGGGGCGGTAGGTAGGAGGGGCGGTAGAAACGGGGCGGTATAAACTAGTATAGTAACTAGTATTCTAGGGGCGGGGGGCGGTACGGTAGGGGGGGGGCGGTAGTACCGAGAACGGGGCGGTAGGTAAGTGGGGCGGTAGGTAAACTAGTATAGGTGCAGGGGCGGTAGAACTAGTATATTCTATCAGGAGAGAGTTCTAAACTAGTATTAGGGGCGGTAGAGTTCTATTATGAGTTCTAGGGGCGGTATTCTTCGGTGATAAGGGGCGGTATATGAGTTCTATGAGGGGGGGCGGTAAGACCTGTTGTGCGACGACGGAACTAGTATCTAGTATGAGAACTAGTATTTCTATTATAAAACTAACTAGTATTTCTGAGTTCTATTCTATGGGAGTTCTATTGGAGTTCTATCGCTCAACTAGTATTACCGAACTAGTATTGCGAAACTAGTATCCCGCAACTAGTATTCACTAGAAACTTTCAATAATTTGGGCCTGAACGCGGTTGCCGCGTCATAGTATTAGATCTATTCGGCTACTGCGTAATGCAAGCTTGCAATGGGTTGAGTGTCACGGACACGATCTAGTCTTGCGCAGAGTCTTATCCAAGCGCTTGGCCCACGCACTTAACCAAGCCCAGCCTCAGTATAGACTCACACTACATGTTGGCCTGGATATGCGCTGACGGCTACGTAAGGTCTCAACCTTGTCGAGGACGACATGCGCTGTCAACAAGACCGGTCGCTAGCCGCGATACGTTCTGGGGATTAACGAACGGGGAGGTCCCGCTGAGGACCACCACGAATGATAAGGTTGCGGTGCTGAATGCTTCGTAGCATTCCAGGTGACACCGCCGTTGATTTCGCTCTGGGTTCATAAACGGGCGAAGCCGCAGCAGCTGCTTCCAGGGCGTTAAACTGCAGCTGGGAGATAAGTACGAGATTAGCCCGATCATTCAACCTAAATTAATCACCCGAAGGAGTAGTCAGTGTGTCTTTGCTTGGGACCCGCCCCAGCATTTACATTTCCCCCCGAAGCCACGCATCATGGTGGCAACGACCTAATGTGTAATACGATTACTGGATCGCCCGGCGATATAATGGCCTGCTGCTAGTTATTATCCCCATAGGAGTTTCGTGCGTATTACCGGTCGACTTCCGACCTAGAGTGAGCCTTCACCGATGGTGGATACGAAGAAATTAAAGTTTATTGTCACGTTATAGTATACCTATGATTTTGGACTAAATGTTGAGGTCCGCATTCCCTTTCTGTTGAACAAAATCTATGGCCGTTTGAAAGAAATAATGAGTTGTGAGCCGGGGCTGGCCCTTGCTTAACCTTTACTGTAGTTTTGTGTTCGCGCGGTTAAGTTAGGACGGAGGGTCCTGTTTTTTATAGAGGCCTAGGTAATATGGTTAACGTCGGAGTGACAGATACCTCACTCGGCGTGGCTCACGGAGAGTTGAGAGGACTAGATCCGAGCTTTCGCAGTTTGGGAAGTGAGAGGCCCGGAGTACCTTCAGCCATTTAGCCATTTGCTCAGCCATTTTTCGGGGTCAGCCATTCAGCCATTTGGCACTTGTCCGTGCTCGAGTTCACCAGGTGGGATGCTGCGTGGGATGCTGTGGGATGCGCCATTTGCGTGGGATGCACAACCTGCTTGGTGCACAGCCGTGGGATGCGCGCCATTTCCGATTGTCAACAGCCATCGATTGTCACCCTCGATTGTCAACGATTGTCAGACGATTGTCAGCATTTGTGGGATGCATAGCAGCCCGATTGTCATAGGACGCAGCGCGTGGCGATTGTCATCCGTTAAAAGCGATTGTCATGTGGGATGCCGATTGTCAATGCCATTTATTTAAGCGATTGTCAATTGTCCGATTGTCATGGGATGCACCGATTGTCATTTTTTCGATTGTCAATGCTTTGACAGCCGATTGCGATTGTCACACATGTCAGTGGGATGCCATTTCGATTGTCATGCCCATTTTTTCAGCCAGCCACGATTGTCAAGCCATTTCAGCCATTGTGGGGTGGGACGATTGCGATTGTCAGCGTGGGAGTGGGATGCGCGCGATTGTCAGTGGGATGCGCGATTGTCAGATTGTCACGATTGTCACGATTGTCACGCGACGATTGTCATTGTCCGACGATTGTCAACGATTGTCA"

l = 553
k = 9
t = 19
FrequentPatterns = BetterClumpFinding(text, l, k, t)
print(FrequentPatterns)

